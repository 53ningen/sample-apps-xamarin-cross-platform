format_version: 1.3.1
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

app:
  envs:
  - BITRISE_PROJECT_PATH: Multiplatform.sln
  - BITRISE_XAMARIN_CONFIGURATION: calabash
  - BITRISE_XAMARIN_PLATFORM: Any CPU

  - BITRISE_EMULATOR_NAME: Emulator
  
workflows:
  calabash:
    steps:
    - git-clone:
    - certificate-and-profile-installer:
    - nuget-restore:
    - xamarin-archive:
        inputs:
        - project_type_whitelist: android,ios
    - calabash-ios-uitest:
        inputs:
        - work_dir: iOS
    - create-android-emulator:
        run_if: .IsCI
        inputs:
        - name: $BITRISE_EMULATOR_NAME
    - start-android-emulator:
    - calabash-android-uitest:
        inputs:
        - work_dir: Droid
    - deploy-to-bitrise-io:
